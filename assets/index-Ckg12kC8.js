var a=Object.defineProperty;var h=(n,e,t)=>e in n?a(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var s=(n,e,t)=>(h(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();class u{constructor({dropdown:e,parent:t,dropdownHideCallback:o,transitionMs:i,frames:r}){s(this,"$dropdown",null);s(this,"items",null);s(this,"$wrapper",null);s(this,"transitionMs",300);s(this,"framesPerSecond",30);s(this,"heightPerFrame",null);s(this,"classNames",{item:`${d}__item`,wrapper:`${d}__wrapper`});s(this,"$parent",null);s(this,"hideCallback",null);s(this,"documentClickHandler",this.hideByDocumentClick.bind(this));s(this,"touched",!1);this.$dropdown=e,this.transitionMs=i||this.transitionMs,this.framesPerSecond=r||this.framesPerSecond,this.$parent=t||null,this.hideCallback=o||null,this.getElements(),this.addEvents(),this.getHeightPerFrame()}getElements(){this.items=Array.from(this.$dropdown.querySelectorAll(`.${this.classNames.item}`)),this.$wrapper=this.$dropdown.querySelector(`.${this.classNames.wrapper}`)}getHeightPerFrame(){return this.heightPerFrame?this.heightPerFrame:(this.heightPerFrame=Math.ceil(this.$wrapper.offsetHeight/(this.transitionMs/this.framesPerSecond)),this.heightPerFrame)}toggleDropdown(e){let t=0,o=e?this.$dropdown.offsetHeight:0;const i=()=>{const c=e?o-this.getHeightPerFrame():o+this.getHeightPerFrame();return c>this.$wrapper.offsetHeight?this.$wrapper.offsetHeight:c<0?0:c};e?document.removeEventListener("click",this.documentClickHandler):document.addEventListener("click",this.documentClickHandler);const r=setInterval(()=>{if(t>=this.transitionMs/this.framesPerSecond){clearInterval(r);return}o=i(),this.$dropdown.style.height=`${o}px`,++t},this.transitionMs/this.framesPerSecond)}hideByDocumentClick(e){this.$parent&&!this.$parent.contains(e.target)&&(this.hideCallback&&this.hideCallback(),this.toggleDropdown(!0))}addEvents(){this.items.forEach(e=>{e.addEventListener("click",this.select.bind(this))})}select({currentTarget:e}){this.touched=!0,this.hideCallback&&this.hideCallback(e),this.toggleDropdown(!0)}clearSelected(e){if(!this.touched)return;const t=this.items.find(o=>o.hasAttribute(e));t&&t.removeAttribute(e)}setSelected(e,t){t.setAttribute(e,"true")}}const d="dropdown",m=document.querySelector("h1").textContent;function p(){return function(n){return`${m} ${n}`}}class f{constructor(){s(this,"attrs",{methodName:"data-select-service-method"})}methodDefinition({select:e,selected:t}){switch(e.getAttribute(this.attrs.methodName)){case"heading":this.valueToHeading(t.value);break;case"alert":this.textToAlert({text:t.text,timeout:500});break;default:console.error("Метод для элемента не определён");break}}valueToHeading(e){const t=p();document.querySelector("h1").innerText=t(e)}textToAlert({text:e,timeout:t}){setTimeout(()=>{alert(e)},t)}}const $=new f;class g{constructor(e){s(this,"$select",null);s(this,"$button",null);s(this,"$text",null);s(this,"$dropdown",null);s(this,"dropdownInstance",null);s(this,"classNames",{onLoad:{button:`${l}__button`,text:`${l}__text`,dropdown:`${l}__dropdown`},itemText:"dropdown__item-text"});s(this,"modifiers",{opened:"opened",selected:"selected"});s(this,"attrs",{selected:"data-selected",value:"data-value"});this.$select=e,this.getElements(),this.initDropdown(),this.addEvents()}getElements(){Object.keys(this.classNames.onLoad).forEach(e=>{this[`$${e}`]=this.$select.querySelector(`.${this.classNames.onLoad[e]}`)})}addEvents(){this.$button.addEventListener("click",this.selectButtonClickHandler.bind(this))}selectButtonClickHandler(){const e=this.$select.classList.contains(`${l}_${this.modifiers.opened}`);this.$select.classList[e?"remove":"add"](`${l}_${this.modifiers.opened}`),this.dropdownInstance.toggleDropdown(e)}hideDropdownCallback(e=null){this.$select.classList.remove(`${l}_${this.modifiers.opened}`),e&&this.selectedHandler(e)}selectedHandler(e){this.dropdownInstance.clearSelected(this.attrs.selected),this.dropdownInstance.setSelected(this.attrs.selected,e),this.selected={element:e,text:e.querySelector(`.${this.classNames.itemText}`).textContent,value:e.getAttribute(this.attrs.value)},this.$text.innerText=this.selected.text,this.$select.classList.add(`${l}_${this.modifiers.selected}`),$.methodDefinition({select:this.$select,selected:{text:this.selected.text,value:this.selected.value}})}initDropdown(){this.dropdownInstance=new u({dropdown:this.$dropdown,parent:this.$select,dropdownHideCallback:this.hideDropdownCallback.bind(this)})}}const l="select";function w(){document.querySelectorAll(`.${l}`).forEach(n=>{new g(n)})}document.addEventListener("DOMContentLoaded",()=>{w()});
